#pragma once // -*- C++ -*-

#include <catch2/catch_test_macros.hpp>
#include <span>
#include <string>


namespace turner_test {


inline std::string case_name ()
{
	return Catch::getResultCapture().getCurrentTestName();
}


bool has_ci_environment_variable ();
inline const bool on_ci = has_ci_environment_variable();


struct bad_alloc_once
{
	static inline bool fail = false;

	bad_alloc_once () noexcept
	{
		fail = true;
	}

	~bad_alloc_once () noexcept
	{
		fail = false;
	}
};


constexpr uint16_t operator"" _u16 (unsigned long long int v)
{
	return (uint16_t)v;
}

inline std::span<const std::byte> operator"" _b (const char *v, size_t n)
{
	return std::as_bytes(std::span{v, n});
}


} // namespace turner_test
